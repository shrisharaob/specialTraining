\section{Results}
Orientation selectivity(OS) has been studied extensively in cat and monkey since its discovery by Hubel and Wiesel in the primary visual cortex(V1). When presented with oriented bar stimuli, the response of a V1 neuron increases when the bar is optimally oriented in a certain direction. In these animals, anatomically proximate neurons in the V1 have very similar preferred orientation forming orientation maps \cite{powell1959some, ohki2007specificity}. Orientation maps consist of OS neurons that are neatly arranged to form pinwheel-like patterns. Each pinwheel has a singularity at the center and orientation domains away from the center. Assuming connection probabilities drop with anatomical distance, neurons in the orientation domains receive inputs mostly from neurons with similar preferred orientation(PO). It has been proposed that strong OS is possible only in the presence of functional connectivity,  where neurons with similar orientation preference have a higher probability of connection \cite{ohki2007specificity}. \\
Strong OS has also been observed in rats, mice and squirrels. Extra-cellular recordings and two-photon calcium imaging show no evidence for the existence of orientation maps in these animals. Instead, OS neurons in the rodent V1 are arranged in a salt and pepper fashion where the POs of neurons are interspersed forming no discernible pattern \cite{ohki2007specificity}. In addition, the evidence for functional connectivity in V1 of rodents is mixed. How can strong orientation selectivity be achieved without a functional architecture? Since there is strong OS in rodent V1 in spite of an orientation map, it was hypothesized that rodent V1 should posses a functional architecture. Hansel and van Vreeswijk \cite{Hansel2012} proposed an alternative solution where strong OS is achieved in a random network. They demonstrated the mechanism using numerical simulations of a model of L2/3 in rodent V1. The model network consisted of single compartment conductance based neurons with random connectivity and strong synapses(see Methods). The neurons were arranged on two dimensional surface where the connection probabilities between neurons were only dependent on anatomical distance within the surface. L4 neurons were assumed to be OS and L2/3 neurons received feedforward inputs from randomly selected L4 neurons with different POs. Hence the the total input that each L2/3 neurons receives has a large untuned component and a comparably weak tuned part. In the model, the recurrent dynamics of the network is such that the total inhibitory and excitatory currents cancel each other. Hence, the large untuned component is dynamically suppressed and the weakly tuned input is amplified by the single neuron threshold rendering the neurons in the network OS. Both the excitatory and inhibitory populations exhibit strong OS. The inhibitory population in the model had tuning properties very similar to the excitatory population. However, there is a growing consensus that PV\textsuperscript{+} cells in rodents are more broadly tuned than excitatory neurons \cite{niell2008highly, kerlin2010broadly, liu2009visual, sohya2007gabaergic, kameyama2010difference} (also see \cite{Runyan2010, Ma2010}). Here we show that this can be explained when the inhibitory neurons(PV\textsuperscript{+}) in L2/3 receive more numerous and weaker synapses from L4 than the excitatory population.  We discovered that, it is possible to explain broadly tuned inhibitory cells by incorporating more numerous and weaker feed-forward input to the inhibitory population. In the simulations, it was necessary to scale the synaptic strengths appropriately as the number of feedforward inputs increases to ensure that the mean population activities remain the same(Methods). Since the mean activities were fixed, broadening of the tuning of inhibitory population was not due to a change in firing rates. Recent experimental study in the auditory and visual cortices by Ji et. al. \cite{Ji2015} supports such a bias in the number of feedforward inputs to excitatory and inhibitory populations. This is a prediction that has to be further corroborated in future experiments. In all our simulations, we assumed that the inhibitory population in L2/3 receives weaker and more numerous inputs than the excitatory population($K_{ff}^{E} = 100, \; K_{ff}^{I} = 800$). This gives us mean values of Circular variance($CircVar = 1 - OSI$) that are comparable to the experimental numbers. We studied the effects of excess bidirectionality with these parameters and characterized the spiking irregularity, fluctuations and, response properties of the our L2/3 network model.  \\


%They showed that strong feature selectivity can be achieved in purely random networks under very general conditions. 
%In their model, the recurrent dynamics of the network is such that the total inhibitory and excitatory currents cancel each other. Each neuron in the network receives inputs from other neurons of different POs. Hence the the total input has a large untuned component and a comparably weak tuned part. As noted earlier, the large untuned component is dynamically suppressed and the weakly tuned input is amplified by the single neuron threshold nonlinearity. Both the excitatory and inhibitory populations exhibit strong OS. In fact, this is generic result showing that a randomy connected network of neurons with strong synapses can develop feature selectivity. Which is true only when the total exitatory and inhibitory currents that each neuron receives are approximately equal. \\ 
% Recently, Hansel \& Vreeswijk \cite{Hansel2012} showed that a functional connectivity is not a necessary ingredient for the achievement of strong orientation selectivity. They showed that in a purely random network, strong orientation selectivity can arise provided that cortex in operating in the balanced State. In fact, this is generic result showing that a randomy connected network of neurons with strong synapses can develop feature selectivity. Which is true only when the total exitatory and inhibitory currents that each neuron recieves are approximately equal. \\ 
%The inhibitory population in the model had tuning properties very similar to the excitatory population. This is not compatible with recent experimental results which clearly indicate that inhibitory population(PV\textsuperscript{+}) is more broadly tuned than excitatory neurons. But, here we show that this can be explained when the inhibotory neurons(PV\textsuperscript{+}) in L2/3 recieve recieve more numerous and weaker synapses from L4 than the excitatory population. This is a prediction which has to be tested in future experiments. There is already some evidence from the barrel cortex of the mouse suggesting that such a bias in the number of feedforward inputs the excitatory and inhibitory population. Hence, in all our simulations, we assumed that the inhibory population in L2/3 revieces weaker and more numerous inputs than the excitatory population($K_{ff}^{E} = 100, \; K_{ff}^{I} = 800$). This gives us mean values of Circular variance($CircVar = 1 - OSI$) that are comparable to the exprimental numbers. 
%Although OS has been studied for over 40 years, the mechanism by which feature seletivity arises in the cortex still debated. Here is an example tuning curve from a V1 neuron of the mouse. % The neurons in the V1 of these animals are orgainzed in what is called a salt and pepper fashion, where there is no dercernable arangement of neurons according to their preferred orinetation as we had seen for the Cat. And in addtion to this fact, the evidence for fuctional connectivity in V1 of rodents is mixed. So the question that arises is 'How can strong orientation selectivity be achieved without a functional architecture?
%\subsection{Numerical simulations}
%We studied the effects of bidirectionality in a conductance based model of rodent V1 L2/3 developed by Hansel and van Vreeswijk \cite{Hansel2012}. 
% Neurons in L2/3 rodent V1 show strong OS which are arranged in a salt and pepper fashion. However in primates like Cat and Monkey, the neurons are arranged in a manner such that anatomically close by neurons have similar PO. Such an arrangement leads to the well documented orientaion maps. Thus, it was hypothesized that strong OS requires a functional architecture where neurons with similar OS are connected to each other. Since there is no strong OS in rodent V1 in spite of an orientation map, it was it was claimed that rodent V1 should posses functional architecture. Hansel and van Vreeswijik proposed an alternative solution. They showed that strong feature selectivity can be achieved in purely random networks under very general conditions. In their model, the recurrent dynamics of the network is such that the total inhibitory and excitatory currents cancel each other. Each neuron in the network recieves inputs from other neurons of different POs. Hence the the total input has a large untuned component and a comparably weak tuned part. As noted earlier, the large untuend component is dynamically suppressed and the weakly tuned input is amplified by the single neuron threshold nonlinearity. Both the excitatory and inhibitory populations exhibit strong OS. However, there is a growting concensus that PV$^{+}$ cells are broadly tuned in ordents. We discovered that, it is possible to explain broadly tuned inhibitory cells by incorporating more numerous and weaker feed-forward input to the inhibitory population. \\

\emph{\textbf{Model with excess bidirectionality:}} Let us consider a random $N \times N$ connectivity matrix with each neuron in the network receiving $K$ inputs on average. In such networks, the expected number of bidirectional connections occurring just by chance is $\frac{K^2}{N}$. Excess bidirectionality was introduced in the network such that the number of bidirectional connections were above chance level with a probability $p$, giving on average $pK$ number of bidirectional connections. The probability $p$ can be interpreted as a symmetry parameter. It quantifies the degree of symmetry for a connectivity matrix. A symmetric random matrix would be characterized by $p = 1$ and a non-symmetric random matrix will have $p = 0$. %We study the deviation of the dynamics of the network
Excess bidirectionality was introduced in all the three possible combinations, i.e (i) within the Excitatory(E) population(E-to-E), (ii) within the Inhibitory(I) population (I-to-I) and, (iii) betweeen Excitatory and Inhibitory populations(E-to-I). \\

%E-to-E bidirectionality had neligible effects. I-to-I bidirectionality was efficacious in slowing down fluctuatios and thereby increasing trial to trial response variability. The time scale of slow fluctuations could be well approximated by a power law. Slow synapses in addition to I-to-I bidirectionality promote multistability. And, E-to-I bidirectionality introduces negative auto-correlations in the spiking responses. 

%Using the modified model of Hansel \& van Vreeswijk accounting for broadly tuned inhibitory population we characterized the the spiking irregularity, fluctuations and, response properties of the L2/3 model network with excess bidirectionality. 
%The firing rate, circular variance and Fano factor distributions were computed for each 
% \textbf{•}case.\\

\emph{\textbf{E-to-E bidirectionality:}} Excess E-to-E bidirectionality has been observed experimentally at probabilities in the range of $p = 0.2$ to $p = 0.3$ \cite{Song2005}. When this probability is non-zero in a network, it leads to the formation of a significant number of loops in the network connectivity. Such loops can lead to non-negligible positive or negative feedback input currents if the effect is of $O(Threshold)$. We recall again that $O(Threshold)$ changes lead to emergence of interesting properties in a balanced network. To see how such loops can contribute effects of $O(Threshold)$ let us consider one E neuron in a network with excess bidirectional probability $p$ where each neuron receives $K$ connections on average. Then, the expected number of bidirectional connections that this neuron receives is $pK$. When this neuron fires a spike, it results in an increase in the input to all the neurons it projects to by an amount proportional to $\frac{J_{EE}}{\sqrt{K}}$, thus increasing their probability of firing. And a fraction $p$ of those neurons project back to the neuron under consideration. This results in the neuron receiving an additional input proportional to $p J_{EE}^{2}$, which is $O(Threshold)$. Thus E-to-E excess bidirectionality should lead to a delayed positive self-coupling. Therefore, presence of a fine structure such as bidirectionality in the network connectivity can lead to significant temporal correlations in the inputs. Whereas, in a balanced network with random connectivity, the neuronal activities are weakly correlated resulting in all the neurons receiving weakly correlated inputs.\\ %Presence of a fine structure such as bidirectionality in the network connectivity can lead to significant temporal correlations in the inputs. We are interested in studying the effect of excess bidirectionality on the the temporal correlations of the activities. 
However, to what extent are these effects of fine structure noticeable in realistic model of V1?  We studied this question by quantifying the dynamics and functional properties in our L2/3 model with excess bidirectionality in E-to-E. For each neuron the spike time autocorrelation function computed and normalized so that it converged asymptotically to its firing rate. Which was then averaged over all the neurons  to compute the population averaged spike time autocorrelation function. The simulations show that E-to-E bidirectionality has negligible effects even at high levels of bidirectionality (Fig. \ref{fig:e2e0}a \& Fig. \ref{fig:e2e0}b). The firing rate distribution of E and I cells for networks with bidirectional probability as high as $p = 0.8$ show no noticeable change as it approximately overlaps with control($p = 0$, i.e random network) condition(Fig. \ref{fig:e2e1}a \& \ref{fig:e2e1}b). Similarly, the circular variance and Fano factor distributions(Fig. \ref{fig:e2e0}c \& \ref{fig:e2e0}d) of both the excitatory and inhibitory populations remain unchanged compared to those of in the control condition. The spiking irregularity as characterized Thus, bidirectionality in E-to-E does not significantly change neither the dynamics nor the functional properties of the network. Why is there no effect even at excess bidirectional probabilities close to one?  This could be explained when we consider the balance conditions: $J_{EI} > J_{EE}$ and $\frac{J_{EI}}{J_{EE}} < \frac{J_{II}}{J_{IE}}$ \cite{carl1998}. The average E-to-E synaptic strength is smaller compared to that of average I-to-E and I-to-I, hence excess bidirectionality in E-to-E has negligible effect on the dynamics of the network. Furthermore, since I-to-I synaptic strength is strong, we can hypothesize that the effects of excess bidirectionality might be more pronounced when it is introduced in the I population. So, we subsequently studied excess bidirectionality in the I population. \\

\emph{\textbf{I-to-I bidirectionality:}} We observed that excess bidirectionality in I-to-I connectivity leads to longer and longer temporal correlations in the neuronal inputs with increasing probability of bidirectionality. This is reflected in the population averaged spike time autocorrelation(AC) function (Fig. \ref{fig:i2i0}a \& \ref{fig:i2i0}b), which decays with slower and slower time scales as $p \rightarrow 1.0$. The decaying portion of the population averaged spike time autocorrelation was well approximated by an exponential function and decay time was estimated by the exponential fit. Slow decay of AC indicates that the probability that a neuron will spike depends on its history of spiking on the time scale of its AC function, whereas spike times of a Poisson spike train have no such memory of previous spikes. As a result of slow fluctuations in the inputs, the neurons have a greater tendency to fire in bursts.(Fig. \ref{fig:vmtrace}). The inter spike intervals(ISI) of the neurons become positively correlated, this is reflected by the fact that the center of mass of $CV$ distributions shift towards higher values with increasing $p$. Thus, in contrast to E-to-E reciprocity, adding I-to-I bidirectionality is much more efficacious in slowing down the fluctuations. The slower dynamics in the network is due to temporally correlated inputs or slow fluctuations. The origin of these slow fluctuations is due to delayed self-coupling, but mediated through an effective disinhibition. Self-coupling occurs due to the presence loops in the I-to-I connectivity. Let us consider one I cell in the network, after it has fired a spike it hyperpolarizes its postsynaptic I neurons by a small amount. A fraction $pK$ of those neurons which project back to the neuron now have a slightly lower probability of firing. Hence, soon after the given neuron has spiked there is a significant reduction in the recurrent inhibition that it receives, thereby increasing the probability of its spiking soon after it has fired a spike. Therefore, the ISIs become positively correlated, such serial correlations in the spike trains leads to higher trial to trial variability. We quantified this in the simulations by keeping the input stimulus fixed and repeating the simulation with different initial conditions. We see that population averaged Fano factor increases with increasing reciprocity(Fig. \ref{fig:i2i1}c, Fig. \ref{fig:i2i1}d). The distribution of Fano factor  gets broader and the mean shifts to higher values. We observed that the effect on functional properties was negligible, there were no drastic changes in the firing rate and circular variance distributions (Fig. \ref{fig:i2i1}).  Thus, I-to-I bidirectionality slows down fluctuations and enhances response variability, but has no significant effect on the functional response properties of the network. However, there is no experimental evidence for strong I-to-I connectivity \cite{Avermann2012}. \\
%At experimentally observed levels of bidirectional probabilities (which is estimated to be in the range 0.2-0.3 ), the tuning properties remain unchanged (Fig. \ref{fig:i2i1}a, Fig. \ref{fig:i2i1}b).     

\emph{\textbf{E-to-I bidirectionality:}} Excess E-to-I bidirectionality, which has been found to occur at very high probabilities which are close to $p=1$ \cite{Yoshimura2005, Otsuka2009}(also see \cite{Avermann2012}) %(in barrel cortex??)
Since the effective self-coupling is negative, E-to-I bidirectionality leads to an increase in negative serial correlations in the spiking activity. The population averaged AC functions now show a distinct undershoot before they converge to their asymptotic values(Fig. \ref{fig:e2i0}). Negative serial correlations reduces the Fano factor(Eq. \ref{ffcveq}). Thus, an optimal combination of excess bidirectionality in I-to-I and E-to-I can lead to no change in the Fano factor. This is because the I-to-I bidirectionality gives rise to positive serial correlations which could be cancelled by a fine tuned amount of excess bidirectionality in E-to-I. \\
%with right probabilities of I-to-I and E-to-I reciprocity, it is possible to obtain a network where their individual effects will cancel each other.  
%E-to-I has the opposite effect. Fluctuations decay much faster than in a random network and Fano factor is reduced (Fig. \ref{fig:e2i0}). E-to-I bidirectionality leads to and increase in negative serial correlations in the spiking activity. As mentioned earlier, negative serial correlations reduces the Fano factor(Eq. \ref{ffcveq}). Thus,  with right probabilities of I-to-I and E-to-I reciprocity, it is possible to obtain a network where their individual effects will cancel each other. \\                 

\emph{\textbf{Slow synapses:}} Postsynaptic currents are usually a sum of a slow and fast components.[ref] The slow component arises due to receptors like GABAb and NMDA. How does the presence of these synapses in addition to excess bidirectionality effect the input fluctuations? To address this question, we studied the effect of reciprocity in the presence of slow synapses by increasing the time constants of recurrent and feed forward synapses. Fig.\ref{fig:slowsyn0} shows that slow synapses and strong I-to-I bidirectionality lead to a large increase in the decorrelation times and Fano factors. For small values of $p$, the decorrelation times were approximately overlapping when they were normalized by the synaptic respective time constants. On a loglog plot (Fig. \ref{fig:slowsyn0}a, \ref{fig:slowsyn0}b) we see that normalized decay times linearly decrease for values of $1-p$ close to 1(or small values of $p$). The linear part of the loglog plot could be well approximated by a power law. [TODO: more details]   \\              
A fully random network is characterized by a single stable state and is independent of initial conditions. This was verified by comparing the steady state firing rates of individual neurons in simulations started with different initial conditions.  Fig.\ref{fig:slowsyn0}e shows that steady state firing rates of all the neurons converge to nearby values for two different initial conditions. In the presence of slow synapses, the steady state firing rates become dependent on initial conditions.
The network converges to different steady states for different initial conditions, which is clearly seen in the scatter plot (Fig. \ref{fig:slowsyn0}f). Thus slow synapses along with large I-to-I bidirectionality gives rise to mutistability in our model. To ensure that this was not an effect of poor firing rate estimates, these simulations were run for longer times(350s). As a further test we computed the population averaged mean squared difference of the firing rates between the two initial conditions, which converges to a finite value as the simulation time is increased(supp. fig.). Hence, in the presence of slow synapses and strong I-to-I bidirectionality the steady state firing rates of the neurons depends on the initial conditions. \\
%A fully random network is characterized by a single ground state. Fig. \ref{fig:slowsyn0}e shows that steady state firing rates of all the neurons converge to nearby values even though the simulations are started with different initial conditions. On the other hand, a fully bidirectional network is very similar to a diluted spin glass. Thus a replica symmetry breaking (RSB) may be expected in this case. Therefore, as the level of bi-directionality is increased one can expect glassy behaviour to appear with a slowing down of the fluctuations. In the simulations this is seen in the presence of slow synapses at high levels of bidirectionality (Fig. \ref{fig:slowsyn0}f).

Thus, we have show that excess bidirectional connections between I-to-I slow down the fluctuations in the neuronal input in balanced networks. As a result, the autocorrelation of the activity decays more slowly than in a corresponding Erdös-Rényi network. Furthermore, bidirectional connections between I cells increase the Fano factor of the spike count. These phenomena are due to the small loops that the bidirectionality induces in the network architecture. Together with the relatively strong synapses in balanced networks these lead to a non-negligible effective delayed self-coupling. On the other hand E-to-I bidirectionality reduces the decorrelation time and response variability. Slow synapses and I-to-I bidirectionality lead to a further increase in decorrelation time and promote multistability.

%Remarkably, bidirectional connections between I cells are more efficacious in slowing down the dynamics than those between E cells. 
%We show that a balanced network model of rodent V1 with conductance-based spiking neurons and excess biderctionality behaves qualitatively similarly to the binary network. 



\section{Results}
We studied the effects of bidirectionality in a model of L2/3 developed by Hansel \& van Vreeswijk\cite{Hansel2012} for explaining OS in rodent V1 in a random network without specific functional architecture. The model network consisted of single compartment conductance based neurons with random connectivity and strong synapses(Methods). The neurons were arranged on two dimensional surface where the connection probabilities between neurons were only dependent on anatomical distance within the surface. L4 neurons were assumed to be OS and L2/3 neurons received feedforward inputs from randomly selected L4 neurons with different POs. Hence the the total input that each L2/3 neurons receives has a large untuned component and a comparably weak tuned part. In the model, the recurrent dynamics of the network is such that the total inhibitory and excitatory currents cancel each other. Hence, the large untuned component is dynamically suppressed and the weakly tuned input is amplified by the single neuron threshold rendering the neurons in the network OS. \\
We used the following procedure to introduce excess bidirectionality in the network. Let us consider a random $N \times N$ connectivity matrix with each neuron in the network receiving $K$ inputs on average. In such networks, the expected number of bidirectional connections occurring just by chance is $\frac{K^2}{N}$. Excess bidirectionality was introduced in the network such that the number of bidirectional connections were above chance level with a probability $p$, giving on average $pK$ number of bidirectional connections. The probability $p$ can be interpreted as a symmetry parameter. It quantifies the degree of symmetry for a connectivity matrix. A symmetric random matrix would be characterized by $p = 1$ and a non-symmetric random matrix will have $p = 0$. %We study the deviation of the dynamics of the network
Excess bidirectionality was introduced in all the three possible combinations, i.e (i) within the Excitatory(E) population(E-to-E), (ii) within the Inhibitory(I) population (I-to-I) and, (iii) betweeen Excitatory and Inhibitory populations(E-to-I). In all our simulations, we assumed that the inhibitory population in L2/3 receives weaker and more numerous inputs than the excitatory population($K_{ff}^{E} = 100, \; K_{ff}^{I} = 800$). %We studied the effects of excess bidirectionality with these parameters and 
We characterized the spiking irregularity, fluctuations and, response properties of the our L2/3 network model.  \\

\emph{\textbf{E-to-E bidirectionality has negligible effects:}} Excess E-to-E bidirectionality has been observed experimentally at probabilities in the range of $p = 0.2$ to $p = 0.3$ \cite{Song2005}. When this probability is non-zero in a network, it leads to formation of a significant number of loops in the network connectivity. Such loops can lead to non-negligible positive or negative feedback input currents if the effect is of $O(Threshold)$. $O(Threshold)$ changes lead to emergence of interesting properties in a balanced network. To see how such loops can contribute effects of $O(Threshold)$ let us consider one E neuron in a network with excess bidirectional probability $p$ where each neuron receives $K$ connections on average of strength $\frac{J_{EE}}{\sqrt{K}}$. Then, the expected number of bidirectional connections that this neuron receives is $pK$. When this neuron fires a spike, it results autocorrelation in an increase in the input to all the neurons it projects to by an amount proportional to $\frac{J_{EE}}{\sqrt{K}}$, thus increasing their probability of firing. And a fraction $p$ of those neurons project back to the neuron under consideration. This results in the neuron receiving an additional input proportional to $p J_{EE}^{2}$, which is $O(Threshold)$. Thus E-to-E excess bidirectionality should lead to a delayed positive self-coupling. Therefore, presence of a fine structure such as bidirectionality in the network connectivity can lead to significant temporal correlations in the inputs. Whereas, in a balanced network with random connectivity, the neuronal activities are weakly correlated resulting in all the neurons receiving weakly correlated inputs.\\  
To what extent are these effects of fine structure noticeable in realistic model of V1?  We studied this question by quantifying the dynamics and functional properties in our L2/3 model with excess bidirectionality in E-to-E. For each neuron the spike time autocorrelation function computed and normalized so that it converged asymptotically to its firing rate. It was then averaged over all the neurons  to compute the population averaged spike time autocorrelation function. The simulations show that E-to-E bidirectionality has negligible effects even at high levels of bidirectionality (Fig. \ref{fig:e2e0}a \& Fig. \ref{fig:e2e0}b). The firing rate distributions of E and I cells for networks with bidirectional probability as high as $p = 0.8$ show no noticeable change as it approximately overlaps with control($p = 0$, i.e random network) condition(Fig. \ref{fig:e2e1}a \& \ref{fig:e2e1}b). Similarly, the circular variance and Fano factor distributions(Fig. \ref{fig:e2e0}c \& \ref{fig:e2e0}d) of both the excitatory and inhibitory populations remain unchanged compared to those of in the control condition. The spiking irregularity as characterized by coefficient of variance($CV$) and $CV_2$ also remains unchanged(Fig. \ref{fig:e2e0}e, \ref{fig:e2e0}f). Thus, bidirectionality in E-to-E does not significantly change neither the dynamics nor the functional properties of the network. 

\emph{\textbf{I-to-I bidirectionality leads to slow fluctuations:}} We observed that excess bidirectionality in I-to-I connectivity leads to longer and longer temporal correlations in the neuronal inputs with increasing probability of bidirectionality. This is reflected in the population averaged spike time autocorrelation(AC) function (Fig. \ref{fig:i2i0}a \& \ref{fig:i2i0}b), which decays with slower and slower time scales as $p \rightarrow 1.0$. The decaying portion of the population averaged spike time autocorrelation was well approximated by an exponential function and decay time was estimated by the exponential fit. Slow decay of AC indicates that the probability that a neuron will spike depends on its history of spiking on the time scale of its AC function. Spike times of a Poisson spike train have no such memory of previous spikes. As a result of slow fluctuations in the inputs, the neurons have a greater tendency to fire in bursts.(Fig. \ref{fig:vmtrace}). The inter spike intervals(ISI) of the neurons become positively correlated, this is reflected by the fact that the center of mass of the $CV$ distributions shift towards higher values with increasing $p$. Thus, in contrast to E-to-E reciprocity, adding I-to-I bidirectionality is much more efficacious in slowing down the fluctuations. The slower dynamics in the network is due to temporally correlated inputs or slow fluctuations. The origin of these slow fluctuations is due to delayed self-coupling, but mediated through an effective disinhibition. Self-coupling occurs due to the presence of loops in the I-to-I connectivity. Let us consider one I cell in the network, after it has fired a spike it hyperpolarizes its postsynaptic I neurons by a small amount. A fraction $pK$ of those neurons which project back to the neuron now have a slightly lower probability of firing. Hence, soon after the given neuron has spiked there is a significant reduction in the recurrent inhibition that it receives, thereby increasing the probability of its spiking soon after it has fired a spike. Therefore, the ISIs become positively correlated, such serial correlations in the spike trains leads to higher trial to trial variability. We quantified this in the simulations by keeping the input stimulus fixed and repeating the simulation with different initial conditions. We see that population averaged Fano factor increases with increasing reciprocity (Fig. \ref{fig:i2i1}c, Fig. \ref{fig:i2i1}d). The distribution of Fano factor  gets broader and the mean shifts to higher values. The effect on functional properties was negligible, there were no drastic changes in the firing rate (Fig. \ref{fig:i2i1}a, \ref{fig:i2i1}b) and circular variance distributions (Fig. \ref{fig:i2i1}c, \ref{fig:i2i1}d). Thus, I-to-I bidirectionality slows down fluctuations and enhances response variability, but has no significant effect on the functional response properties of the network. However, there is no experimental evidence for strong I-to-I connectivity \cite{Avermann2012}.\\

\emph{\textbf{E-to-I bidirectionality introduces negative auto-correlations:}} Excess E-to-I bidirectionality has been found to occur at very high probabilities which are close to $p=1$ \cite{Yoshimura2005, Otsuka2009}(also see \cite{Avermann2012}) %(in barrel cortex??)
The effective self-coupling is negative, E-to-I bidirectionality leads to an increase in negative serial correlations in the spiking activity. The population averaged AC functions now show a distinct undershoot before they converge to their asymptotic values(Fig. \ref{fig:e2i0}a, \ref{fig:e2i0}b). Negative serial correlations reduces the Fano factor(Eq. \ref{ffcveq}, Fig. \ref{fig:e2i0}c, \ref{fig:e2i0}d). Thus, an optimal combination of excess bidirectionality in I-to-I and E-to-I can lead to no change in the Fano factor. This is because the I-to-I bidirectionality gives rise to positive serial correlations which could be canceled by a fine tuned amount of excess bidirectionality in E-to-I. \\

\emph{\textbf{Slow synapses promote multistability:}} Postsynaptic currents are usually a sum of a slow and fast components.[ref] The slow component arises due to receptors like GABAb and NMDA. How does the presence of these synapses in addition to excess bidirectionality effect the input fluctuations? To address this question, we studied the effect of reciprocity in the presence of slow synapses by increasing the time constants of recurrent and feed forward synapses. Fig.\ref{fig:slowsyn0} shows that slow synapses and strong I-to-I bidirectionality lead to a large increase in the decorrelation times and Fano factors. For small values of $p$, the decorrelation times were approximately overlapping when they were normalized by the respective synaptic time constants. On a loglog plot (Fig. \ref{fig:slowsyn0}a, \ref{fig:slowsyn0}b) we see that normalized decay times linearly decrease for values of $1-p$ close to 1(or small values of $p$). The linear part of the loglog plot could be well approximated by a power law. [TODO: more details]\\

A fully random network is characterized by a single stable state and is independent of initial conditions. This was verified by comparing the steady state firing rates of individual neurons in simulations started with different initial conditions.  Fig.\ref{fig:slowsyn0}e shows that steady state firing rates of all the neurons converge to nearby values for two different initial conditions. In the presence of slow synapses, the steady state firing rates become dependent on initial conditions.
The network converges to different steady states for different initial conditions, which is clearly seen in the scatter plot (Fig. \ref{fig:slowsyn0}f). Thus slow synapses along with large I-to-I bidirectionality give rise to mutistability in our model. To ensure that this was not an effect of poor firing rate estimates, these simulations were run for longer times(500s). As a further test we computed the population averaged mean squared difference of the firing rates between the two initial conditions, converges to a finite value as the simulation time is increased(supp. fig.[TODO]. Hence, in the presence of slow synapses and strong I-to-I bidirectionality the steady state firing rates of the neurons depends on the initial conditions.\\

Thus, we have show that excess bidirectional connections between I-to-I slow down the fluctuations in the neuronal input in balanced networks. As a result, the autocorrelation of the activity decays more slowly than in a corresponding Erdös-Rényi network. Furthermore, bidirectional connections between I cells increase the Fano factor of the spike count. These phenomena are due to the small loops that the bidirectionality induces in the network architecture. Together with the relatively strong synapses in balanced networks these lead to a non-negligible effective delayed self-coupling. On the other hand E-to-I bidirectionality reduces the decorrelation time and response variability. Slow synapses and I-to-I bidirectionality lead to a further increase in decorrelation time and promote multistability.


